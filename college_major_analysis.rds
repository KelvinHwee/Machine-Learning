install.packages("devtools")
devtools::install_github("jhudsl/collegeIncome")
devtools::install_github("jhudsl/matahari")
dance_start(value = FALSE, contents = FALSE)

library(matahari)
library(collegeIncome)
library(dplyr)
library(ggplot2)

data(college)
sapply(college, function(x) sum(is.na(x))) # to count the NA values
college_noNA <- college[complete.cases(college), ]

data <- college_noNA %>%
        group_by(major_category) %>%
            arrange(desc(p75th), major_category) %>%
                select(1:4, p75th) %>%
                    as.data.frame()

tail(data)

x1 <- data$major_category == "Business"
x2 <- data$major_category == "Engineering"
x3 <- data$major_category == "Biology & Life Science"
x4 <- data$major_category == "Education"
x5 <- data$major_category == "Social Science"

fit <- lm(rank ~ x1+x2+x3+x4+x5+0, data)
summary(fit)

selected1 <- data[x2|x4,]
selected2 <- data[x3|x5,]

# plotting of graphs using ggplot, for the samples that are most different
g <- ggplot(selected1)
g + geom_point(aes(x = p75th, y = rank, colour = factor(major_category), size = 0.5), position = "jitter") + 
    geom_smooth(aes(x = p75th, y = rank), method = "lm")

# plotting of graphs using ggplot, for the samples that are most similar
g <- ggplot(selected2)
g + geom_point(aes(x = p75th, y = rank, colour = factor(major_category), size = 0.5), position = "jitter") + 
    geom_smooth(aes(x = p75th, y = rank), method = "lm")
        
# save a record onto desktop
dance_save("~/Desktop/college_major_analysis.rds")
